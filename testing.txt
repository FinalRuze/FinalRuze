$source = @"
using System;
using System.Runtime.InteropServices;
using System.Threading;

public static class Win32
{
    [DllImport("user32.dll")]
    static extern int GetSystemMetrics(int smIndex);

    [DllImport("user32.dll")]
    static extern IntPtr GetDC(IntPtr hWnd);

    [DllImport("gdi32.dll")]
    static extern bool PatBlt(IntPtr hdc, int nXLeft, int nYLeft, int nWidth, int nHeight, uint dwRop);

    [DllImport("user32.dll", SetLastError = true)]
    static extern bool SetProcessDPIAware();

    public static void CreateStatic()
    {
        SetProcessDPIAware();
        int cx = GetSystemMetrics(0);
        int cy = GetSystemMetrics(1);

        Random random = new Random();

        while (true)
        {
            Thread.Sleep(800);
            IntPtr hdc = GetDC(IntPtr.Zero);

            for (int i = 0; i < 100; i++)
            {
                int x = random.Next(cx);
                int y = random.Next(cy);
                int width = random.Next(10, 100);
                int height = random.Next(10, 100);

                PatBlt(hdc, x, y, width, height, 0xD3D5819A);
            }
        }
    }
}
"@
Add-Type -TypeDefinition $source -Language CSharp
[Win32]::CreateStatic()
