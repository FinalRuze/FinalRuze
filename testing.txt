Option Explicit

Class Win32
    Private Declare Function GetSystemMetrics Lib "user32.dll" (ByVal smIndex As Long) As Long
    Private Declare Function GetWindowDC Lib "user32.dll" (ByVal hWnd As Long) As Long
    Private Declare Function GetDesktopWindow Lib "user32.dll" () As Long
    Private Declare Function SetProcessDPIAware Lib "user32.dll" () As Long
    Private Declare Function DrawIcon Lib "user32.dll" (ByVal hdc As Long, ByVal xLeft As Long, ByVal yTop As Long, ByVal hIcon As Long) As Long
    Private Declare Function GetCursorPos Lib "user32.dll" (lpPoint As POINTAPI) As Long

    Private Type POINTAPI
        x As Long
        y As Long
    End Type

    Public Sub draw()
        SetProcessDPIAware
        Do
            Dim cursorinfo As CURSORINFO
            Dim point As POINTAPI
            Dim ix, iy

            ix = GetSystemMetrics(11) \ 2  ' SM_CXICON
            iy = GetSystemMetrics(12) \ 2  ' SM_CYICON

            GetCursorPos point
            cursorinfo.cbSize = Len(cursorinfo)
            GetCursorInfo cursorinfo

            WScript.Sleep 10

            Dim hwnd, hdc, hIcon
            hwnd = GetDesktopWindow()
            hdc = GetWindowDC(hwnd)
            hIcon = LoadIconA(0, 32513)  ' IDI_ERROR
            DrawIcon hdc, point.x - ix, point.y - iy, hIcon
        Loop
    End Sub

    Private Declare Function LoadIconA Lib "user32.dll" (ByVal hInstance As Long, ByVal lpIconName As Long) As Long
End Class

Dim objWin32
Set objWin32 = New Win32
objWin32.draw
