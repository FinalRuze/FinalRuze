$source = @"
using System;
using System.Runtime.InteropServices;
using System.Threading;

public static class Win32
{
    [DllImport("user32.dll")]
    static extern int GetSystemMetrics(int smIndex);

    [DllImport("user32.dll")]
    static extern IntPtr GetDC(IntPtr hWnd);

    [DllImport("gdi32.dll")]
    static extern bool StretchBlt(IntPtr hdcDest, int nXOriginDest, int nYOriginDest, int nWidthDest, int nHeightDest, IntPtr hdcSrc, int nXOriginSrc, int nYOriginSrc, int nWidthSrc, int nHeightSrc, uint dwRop);

    [DllImport("user32.dll", SetLastError = true)]
    static extern bool SetProcessDPIAware();

    public static void FadeToBlack()
    {
        SetProcessDPIAware();
        int cx = GetSystemMetrics(0);
        int cy = GetSystemMetrics(1);

        IntPtr hdc = GetDC(IntPtr.Zero);

        int alpha = 0xFF; // Starting alpha value (fully opaque)

        while (alpha > 0)
        {
            alpha -= 5; // Decrease alpha by 5 (adjust this value to control the speed of fading)

            Thread.Sleep(50); // Delay between each frame (adjust this value to control the speed of fading)

            // Create a black brush with the current alpha value
            IntPtr brush = CreateSolidBrush((uint)(alpha << 24));

            // Fill the entire screen with the black brush
            IntPtr prevBrush = SelectObject(hdc, brush);
            StretchBlt(hdc, 0, 0, cx, cy, hdc, 0, 0, cx, cy, 0xCC0020);

            // Clean up resources
            SelectObject(hdc, prevBrush);
            DeleteObject(brush);
        }

        // Close the device context
        ReleaseDC(IntPtr.Zero, hdc);
    }

    [DllImport("gdi32.dll")]
    static extern IntPtr CreateSolidBrush(uint crColor);

    [DllImport("gdi32.dll")]
    static extern IntPtr SelectObject(IntPtr hdc, IntPtr hgdiobj);

    [DllImport("gdi32.dll")]
    static extern bool DeleteObject(IntPtr hObject);

    [DllImport("user32.dll")]
    static extern IntPtr ReleaseDC(IntPtr hWnd, IntPtr hdc);
}
"@

Add-Type -TypeDefinition $source -Language CSharp
[Win32]::FadeToBlack()
