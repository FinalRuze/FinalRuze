Const SM_CXSCREEN = 0
Const SM_CYSCREEN = 1
Const SRCCOPY = &HCC0020

Dim user32, gdi32

Set user32 = CreateObject("user32.dll")
Set gdi32 = CreateObject("gdi32.dll")

Function GetSystemMetrics(ByVal nIndex)
    GetSystemMetrics = user32.GetSystemMetrics(nIndex)
End Function

Function GetDC(ByVal hwnd)
    GetDC = user32.GetDC(hwnd)
End Function

Function SetPixel(ByVal hdc, ByVal x, ByVal y, ByVal crColor)
    SetPixel = gdi32.SetPixel(hdc, x, y, crColor)
End Function

Function StretchBlt(ByVal hdc, ByVal x, ByVal y, ByVal nWidth, ByVal nHeight, ByVal hSrcDC, ByVal xSrc, ByVal ySrc, ByVal nSrcWidth, ByVal nSrcHeight, ByVal dwRop)
    StretchBlt = gdi32.StretchBlt(hdc, x, y, nWidth, nHeight, hSrcDC, xSrc, ySrc, nSrcWidth, nSrcHeight, dwRop)
End Function

Function RGB(ByVal r, ByVal g, ByVal b)
    RGB = r Or (g * 256) Or (b * 65536)
End Function

Sub PIP()
    Dim cx, cy, hdc, i, x, y

    cx = GetSystemMetrics(SM_CXSCREEN)
    cy = GetSystemMetrics(SM_CYSCREEN)

    While True
        For i = 0 To 255
            WScript.Sleep 10
            hdc = GetDC(0)

            For x = 0 To cx - 1
                For y = 0 To cy - 1
                    SetPixel hdc, x, y, RGB(i, i, i)
                Next
            Next

            StretchBlt hdc, 50, 50, cx - 100, cy - 100, hdc, 0, 0, cx, cy, SRCCOPY
        Next
    Wend
End Sub

PIP
