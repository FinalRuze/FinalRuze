Option Explicit

Dim strUsername, strPassword, strDescription
Dim objShell, strCommand

strUsername = "NewUser"
strPassword = "NewUserPassword"
strDescription = "New User Account"

Set objShell = CreateObject("WScript.Shell")

' Construct the PowerShell command to create the user account
strCommand = "powershell.exe -Command ""$User = New-LocalUser -Name """ & strUsername & """ -Password (ConvertTo-SecureString -AsPlainText """ & strPassword & """ -Force) -FullName """ & strDescription & """ -Description """ & strDescription & """ -NoPasswordExpiration; If ($User) { Write-Output 'User account created successfully!' } Else { Write-Output 'Error creating user account.' }"""

' Execute the PowerShell command
Dim intReturnCode
intReturnCode = objShell.Run(strCommand, 0, True)

If intReturnCode = 0 Then
    WScript.Echo "User account created successfully!"
Else
    WScript.Echo "Error creating user account."
End If
