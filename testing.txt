Add-Type -TypeDefinition @"
using System;
using System.Runtime.InteropServices;

public class Win32Interop
{
    [DllImport("user32.dll")]
    public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);

    [DllImport("user32.dll")]
    public static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X, int Y, int cx, int cy, uint uFlags);

    [DllImport("user32.dll")]
    public static extern bool GetWindowRect(IntPtr hWnd, out RECT lpRect);

    [StructLayout(LayoutKind.Sequential)]
    public struct RECT
    {
        public int Left;
        public int Top;
        public int Right;
        public int Bottom;
    }

    public const int SW_HIDE = 0;
    public const int SW_SHOWMAXIMIZED = 3;
    public static readonly IntPtr HWND_TOPMOST = new IntPtr(-1);
    public const uint SWP_SHOWWINDOW = 0x0040;
    public const uint SWP_FRAMECHANGED = 0x0020;
}
"@

function FillScreenWithStatic {
    $consoleWindow = [System.Diagnostics.Process]::GetCurrentProcess().MainWindowHandle
    $screenWidth = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Width
    $screenHeight = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Height

    $null = [Win32Interop]::ShowWindow($consoleWindow, [Win32Interop]::SW_SHOWMAXIMIZED)
    $null = [Win32Interop]::SetWindowPos($consoleWindow, [Win32Interop]::HWND_TOPMOST, 0, 0, $screenWidth, $screenHeight, [Win32Interop]::SWP_SHOWWINDOW + [Win32Interop]::SWP_FRAMECHANGED)

    while ($true) {
        $null = [Win32Interop]::GetWindowRect($consoleWindow, [ref]$rect)
        $consoleWidth = $rect.Right - $rect.Left
        $consoleHeight = $rect.Bottom - $rect.Top

        $staticCmd = "mode con cols=$consoleWidth lines=$consoleHeight | set /p =="
        Invoke-Expression $staticCmd
    }
}

FillScreenWithStatic
