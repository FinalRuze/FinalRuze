Imports System
Imports System.Runtime.InteropServices
Imports System.Threading

Module Win32
    Private Declare Function GetSystemMetrics Lib "user32.dll" (ByVal smIndex As Integer) As Integer
    Private Declare Function GetDC Lib "user32.dll" (ByVal hWnd As IntPtr) As IntPtr
    Private Declare Function StretchBlt Lib "gdi32.dll" (ByVal hdcDest As IntPtr, ByVal nXOriginDest As Integer, ByVal nYOriginDest As Integer, ByVal nWidthDest As Integer, ByVal nHeightDest As Integer, ByVal hdcSrc As IntPtr, ByVal nXOriginSrc As Integer, ByVal nYOriginSrc As Integer, ByVal nWidthSrc As Integer, ByVal nHeightSrc As Integer, ByVal dwRop As Integer) As Boolean
    Private Declare Function SetPixel Lib "gdi32.dll" (ByVal hdc As IntPtr, ByVal X As Integer, ByVal Y As Integer, ByVal crColor As Integer) As Integer
    Private Declare Function SetProcessDPIAware Lib "user32.dll" () As Boolean

    Public Sub PIP()
        SetProcessDPIAware()
        Dim cx As Integer = GetSystemMetrics(0)
        Dim cy As Integer = GetSystemMetrics(1)

        While True
            For i As Integer = 0 To 255
                Thread.Sleep(10)
                Dim hdc As IntPtr = GetDC(IntPtr.Zero)

                For x As Integer = 0 To cx - 1
                    For y As Integer = 0 To cy - 1
                        SetPixel(hdc, x, y, RGB(i, i, i))
                    Next
                Next

                StretchBlt(hdc, 50, 50, cx - 100, cy - 100, hdc, 0, 0, cx, cy, &HCC0020)
            Next
        End While
    End Sub

    Private Function RGB(ByVal r As Integer, ByVal g As Integer, ByVal b As Integer) As Integer
        Return r Or (g << 8) Or (b << 16)
    End Function
End Module

Win32.PIP()
