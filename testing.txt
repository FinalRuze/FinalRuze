$source = @"
using System;
using System.Runtime.InteropServices;
using System.Threading;

public static class Win32
{
    [DllImport("user32.dll")]
    static extern int GetSystemMetrics(int smIndex);

    [DllImport("user32.dll")]
    static extern IntPtr GetDC(IntPtr hWnd);

    [DllImport("gdi32.dll")]
    static extern bool StretchBlt(IntPtr hdcDest, int nXOriginDest, int nYOriginDest, int nWidthDest, int nHeightDest, IntPtr hdcSrc, int nXOriginSrc, int nYOriginSrc, int nWidthSrc, int nHeightSrc, int dwRop);

    [DllImport("user32.dll", SetLastError = true)]
    static extern bool SetProcessDPIAware();

    [DllImport("gdi32.dll")]
    static extern IntPtr CreatePen(int fnPenStyle, int nWidth, uint crColor);

    [DllImport("gdi32.dll")]
    static extern IntPtr SelectObject(IntPtr hdc, IntPtr hgdiobj);

    [DllImport("gdi32.dll")]
    static extern bool Rectangle(IntPtr hdc, int nLeftRect, int nTopRect, int nRightRect, int nBottomRect);

    [DllImport("gdi32.dll")]
    static extern bool Polygon(IntPtr hdc, int[] points, int nCount);

    [DllImport("gdi32.dll")]
    static extern IntPtr CreateSolidBrush(uint color);

    [DllImport("gdi32.dll")]
    static extern IntPtr SelectObject(IntPtr hdc, IntPtr hgdiobj);

    [DllImport("gdi32.dll")]
    static extern bool DeleteObject(IntPtr hObject);

    public static void ReversePIP()
    {
        SetProcessDPIAware();
        int cx = GetSystemMetrics(0);
        int cy = GetSystemMetrics(1);

        while (true)
        {
            Thread.Sleep(800);
            IntPtr hdc = GetDC(IntPtr.Zero);

            // Original effect - StretchBlt
            StretchBlt(hdc, 0, 0, cx, cy, hdc, 50, 50, cx - 100, cy - 100, 0x00CC0020);

            // Additional effect 1 - Drawing a red rectangle
            IntPtr redPen = CreatePen(0, 5, 0xFF0000); // Red color pen
            IntPtr oldPen = SelectObject(hdc, redPen);
            Rectangle(hdc, 100, 100, cx - 100, cy - 100);
            SelectObject(hdc, oldPen);

            // Additional effect 2 - Drawing a blue rectangle
            IntPtr bluePen = CreatePen(0, 5, 0x0000FF); // Blue color pen
            IntPtr oldPen2 = SelectObject(hdc, bluePen);
            Rectangle(hdc, 200, 200, cx - 200, cy - 200);
            SelectObject(hdc, oldPen2);

            // Additional effect 3 - Drawing multiple hexagons to fill the screen with rainbow colors
            int hexagonSize = 100;
            int hexagonMargin = 20;
            int hexagonRowCount = (cy - 2 * hexagonMargin) / (hexagonSize + hexagonMargin);
            int hexagonColumnCount = (cx - 2 * hexagonMargin) / (hexagonSize + hexagonMargin);
            int totalHexagons = hexagonRowCount * hexagonColumnCount;

            int[] hexagonXPositions = new int[totalHexagons];
            int[] hexagonYPositions = new int[totalHexagons];

            int startX = hexagonMargin;
            int startY = hexagonMargin;

            // Rainbow colors
            uint[] rainbowColors = new uint[]
            {
                0xFF0000, // Red
                0xFFA500, // Orange
                0xFFFF00, // Yellow
                0x008000, // Green
                0x0000FF, // Blue
                0x4B0082, // Indigo
                0xEE82EE  // Violet
            };

            for (int i = 0; i < totalHexagons; i++)
            {
                int row = i / hexagonColumnCount;
                int column = i % hexagonColumnCount;

                int hexagonX = startX + column * (hexagonSize + hexagonMargin);
                int hexagonY = startY + row * (hexagonSize + hexagonMargin);

                hexagonXPositions[i] = hexagonX;
                hexagonYPositions[i] = hexagonY;

                // Get the corresponding rainbow color
                uint color = rainbowColors[i % rainbowColors.Length];

                // Draw the hexagon outline with the rainbow color
                IntPtr hexagonPen = CreatePen(0, 5, color);
                IntPtr oldPen3 = SelectObject(hdc, hexagonPen);

                int[] hexagonPoints = new int[]
                {
                    hexagonX + hexagonSize / 2, hexagonY,
                    hexagonX + hexagonSize, hexagonY + hexagonSize / 3,
                    hexagonX + hexagonSize, hexagonY + 2 * hexagonSize / 3,
                    hexagonX + hexagonSize / 2, hexagonY + hexagonSize,
                    hexagonX, hexagonY + 2 * hexagonSize / 3,
                    hexagonX, hexagonY + hexagonSize / 3
                };

                Polygon(hdc, hexagonPoints, hexagonPoints.Length / 2);

                // Fill the hexagon with the corresponding rainbow color
                IntPtr hexagonBrush = CreateSolidBrush(color);
                IntPtr oldBrush = SelectObject(hdc, hexagonBrush);
                Polygon(hdc, hexagonPoints, hexagonPoints.Length / 2);
                SelectObject(hdc, oldBrush);

                // Cleanup
                SelectObject(hdc, oldPen3);
                DeleteObject(hexagonPen);
                DeleteObject(hexagonBrush);
            }
        }
    }
}
"@
Add-Type -TypeDefinition $source -Language CSharp
[Win32]::ReversePIP()
