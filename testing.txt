# Load the System.Drawing assembly
Add-Type -TypeDefinition @"
    using System;
    using System.Drawing;
    using System.Drawing.Imaging;

    public class GdiEffects
    {
        public static void ApplyEffects(string imagePath)
        {
            // Load the image
            Image image = Image.FromFile(imagePath);

            // Apply effects
            using (Graphics graphics = Graphics.FromImage(image))
            {
                // Grayscale effect
                ImageAttributes grayscaleAttributes = new ImageAttributes();
                grayscaleAttributes.SetColorMatrix(new ColorMatrix(new float[][] {
                    new float[] {0.299f, 0.299f, 0.299f, 0, 0},
                    new float[] {0.587f, 0.587f, 0.587f, 0, 0},
                    new float[] {0.114f, 0.114f, 0.114f, 0, 0},
                    new float[] {0, 0, 0, 1, 0},
                    new float[] {0, 0, 0, 0, 1}
                }));
                graphics.DrawImage(image, new Rectangle(0, 0, image.Width, image.Height),
                    0, 0, image.Width, image.Height, GraphicsUnit.Pixel, grayscaleAttributes);

                // Sepia effect
                ImageAttributes sepiaAttributes = new ImageAttributes();
                sepiaAttributes.SetColorMatrix(new ColorMatrix(new float[][] {
                    new float[] {0.393f, 0.349f, 0.272f, 0, 0},
                    new float[] {0.769f, 0.686f, 0.534f, 0, 0},
                    new float[] {0.189f, 0.168f, 0.131f, 0, 0},
                    new float[] {0, 0, 0, 1, 0},
                    new float[] {0, 0, 0, 0, 1}
                }));
                graphics.DrawImage(image, new Rectangle(image.Width + 10, 0, image.Width, image.Height),
                    0, 0, image.Width, image.Height, GraphicsUnit.Pixel, sepiaAttributes);
            }

            // Save the modified image
            string outputPath = imagePath.Replace(".", "_modified.");
            image.Save(outputPath, ImageFormat.Png);
            image.Dispose();

            Console.WriteLine("Effects applied successfully. Output: {0}", outputPath);
        }
    }
"@

# Provide the path to your image file
$imagePath = "C:\Path\To\Your\Image.jpg"

# Apply the effects
[GdiEffects]::ApplyEffects($imagePath)
