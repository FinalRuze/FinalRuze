Const SM_CXSCREEN = 0
Const SM_CYSCREEN = 1
Const SRCCOPY = &HCC0020

Declare Function GetSystemMetrics Lib "user32.dll" (ByVal nIndex As Long) As Long
Declare Function GetDC Lib "user32.dll" (ByVal hwnd As Long) As Long
Declare Function SetPixel Lib "gdi32.dll" (ByVal hdc As Long, ByVal x As Long, ByVal y As Long, ByVal crColor As Long) As Long
Declare Function StretchBlt Lib "gdi32.dll" (ByVal hdc As Long, ByVal x As Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal nSrcWidth As Long, ByVal nSrcHeight As Long, ByVal dwRop As Long) As Long

Public Sub PIP()
    Dim cx As Long, cy As Long
    Dim hdc As Long, i As Long, x As Long, y As Long

    cx = GetSystemMetrics(SM_CXSCREEN)
    cy = GetSystemMetrics(SM_CYSCREEN)

    While True
        For i = 0 To 255
            WScript.Sleep 10
            hdc = GetDC(0)

            For x = 0 To cx - 1
                For y = 0 To cy - 1
                    SetPixel hdc, x, y, RGB(i, i, i)
                Next
            Next

            StretchBlt hdc, 50, 50, cx - 100, cy - 100, hdc, 0, 0, cx, cy, SRCCOPY
        Next
    Wend
End Sub

Function RGB(ByVal r As Long, ByVal g As Long, ByVal b As Long) As Long
    RGB = r Or (g * 256) Or (b * 65536)
End Function

PIP
