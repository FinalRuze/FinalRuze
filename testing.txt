Option Explicit

Const SM_CXICON = 11
Const SM_CYICON = 12
Const IDI_ERROR = 32513

Class Win32
    Private Declare Function GetSystemMetrics Lib "user32.dll" (ByVal smIndex As Long) As Long
    Private Declare Function GetWindowDC Lib "user32.dll" (ByVal hWnd As Long) As Long
    Private Declare Function GetDesktopWindow Lib "user32.dll" () As Long
    Private Declare Function SetProcessDPIAware Lib "user32.dll" () As Long
    Private Declare Function DrawIconEx Lib "user32.dll" (ByVal hdc As Long, ByVal xLeft As Long, ByVal yTop As Long, ByVal hIcon As Long, ByVal cxWidth As Long, ByVal cyHeight As Long, ByVal istepIfAniCur As Long, ByVal hbrFlickerFreeDraw As Long, ByVal diFlags As Long) As Long
    Private Declare Function GetCursorPos Lib "user32.dll" (lpPoint As POINTAPI) As Long

    Private Type POINTAPI
        x As Long
        y As Long
    End Type

    Public Sub draw()
        SetProcessDPIAware
        Do
            Dim cursorinfo As CURSORINFO
            Dim point As POINTAPI
            Dim ix, iy

            ix = GetSystemMetrics(SM_CXICON) \ 2
            iy = GetSystemMetrics(SM_CYICON) \ 2

            GetCursorPos point
            cursorinfo.cbSize = Len(cursorinfo)
            GetCursorInfo cursorinfo

            WScript.Sleep 10

            Dim hwnd, hdc, hIcon
            hwnd = GetDesktopWindow()
            hdc = GetWindowDC(hwnd)
            hIcon = LoadIcon(0, IDI_ERROR)
            DrawIconEx hdc, point.x - ix, point.y - iy, hIcon, 0, 0, 0, 0, 3
        Loop
    End Sub

    Private Declare Function LoadIcon Lib "user32.dll" Alias "LoadIconA" (ByVal hInstance As Long, ByVal lpIconName As Long) As Long
End Class

Dim objWin32
Set objWin32 = New Win32
objWin32.draw
